---
title: 被动回复
description: 介绍 VeAIOps 中的被动回复 Agent 功能与配置
navigation:
  icon: i-lucide-message-circle-reply
---


被动回复 Agent (Reactive Agent) 响应用户的直接提问，当用户在群聊或私聊中 @机器人时，智能体会理解用户问题并提供回复。通过会话记忆、子 Agent 协作和工具集成，为用户提供个性化和上下文相关的交互体验。

* 采用**主Agent-子Agent-Tools**架构，确保可扩展性。
* 集成 [**长期记忆**](https://volcengine.github.io/veadk-python/memory/introduction/){:target="_blank" rel="noopener noreferrer"} ，支持个性化内容。


::tip
被动回复需要用户显式 @机器人触发，与主动回复 Agent 形成互补。
::


## 设计模式

::steps

### @机器人触发检测

检查消息中是否提及（@）机器人，未提及则跳过处理

### 模式选择

- **问答**：用户 @机器人并附带问题时，使用主 Agent 进行回答
- **总结**：用户仅 @机器人无其他内容时，调用 Summary Agent 生成群聊总结

### 会话记忆加载

- **长期记忆 (LTM)**：挂载火山Viking 记忆库

### Agent 执行

- **问答模式**：调用主 ReactiveAgent，可使用内置工具（获取时间、网页搜索等）、以及SubAgent（如Summary Agent）
- **总结模式**：调用 SummaryAgent，自动获取群聊历史并生成总结

### 回复生成与发送

生成回复内容并回复用户

### 会话记忆保存

会话结束后自动保存到长期记忆（LTM），确保重要对话内容持久化

::


## 配置与概念说明

被动回复 Agent 设计理念是开箱即用，无需复杂配置。

::tip
VeAIOps 会给每个机器人设置默认Prompt与工具，开箱即用
::



内置工具列表

| 组件      | 名称 | 类型     | 说明                         |
| -------- |----- | -------- | ---------------------------- |
| 获取时间   |  get_utc_time    |  Tools    |    获取utc时间      |
| 网页搜索   |   web_search      | Tools     |    搜索互联网内容     |
| 网页获取   |   linkreader      | Tools     |   非登录页面 <br> 飞书文档（需机器人有阅读权限）  |
| 总结     | SummaryAgent | 子 Agent   |  生成群聊总结  |


同时也支持可选扩展

| 组件          | 类型     | 说明                         |
| ------------- | -------- | ---------------------------- |
| [外部工具](https://volcengine.github.io/veadk-python/tools/builtin-tools){:target="_blank" rel="noopener noreferrer"}      | Tools    | 工具调用     | 自动配置 instruction   |
| [子Agent](https://google.github.io/adk-docs/agents/multi-agents/#agent-hierarchy-parent-agent-sub-agents){:target="_blank" rel="noopener noreferrer"} | 子 Agent | 多Agent协同         |




## 场景示例

::tabs

  ::tab{label="直接问答"}
  ::card
  用户 @机器人直接提问，获取即时回答

  **示例对话**：
  ```text
  用户：@AI助手 生产环境的数据库连接配置在哪里？

  被动回复 Agent：
  生产环境的数据库连接配置位于以下位置：

  **ConfigMap 配置**
  - 名称：`database-config`
  - 命名空间：`production`
  - 查看命令：kubectl get configmap database-config -n production -o yaml

  **主要配置项**：
  - host: db.prod.example.com
  - port: 3306
  - max_connections: 100

  **修改步骤**：
  1. 编辑配置：kubectl edit configmap database-config -n production
  2. 重启应用：kubectl rollout restart deployment/app -n production

  📚 参考：《生产环境配置管理指南》
  ```
  ::
  ::

  ::tab{label="多轮对话"}
  ::card
  支持基于上下文的连续交互，机器人能记住前面的对话内容

  **示例对话**：
  ```text
  用户A：@AI助手 最近用户反馈登录很慢

  被动回复 Agent：
  我来帮您分析登录慢的问题。根据监控数据显示：

  **登录接口性能 (最近24小时)**：
  - 平均响应时间：2.5秒 (正常值：500ms)
  - P95 响应时间：5.2秒
  - P99 响应时间：8.7秒

  确实存在明显的性能下降。

  用户A：有什么优化建议吗？

  被动回复 Agent：
  基于当前情况，建议按优先级进行以下优化：

  **立即处理**：
  1. 检查数据库慢查询日志
  2. 评估用户会话缓存命中率
  3. 监控登录相关的第三方服务状态

  **短期优化**：
  1. 增加Redis缓存层
  2. 优化用户信息查询索引
  3. 考虑引入登录限流机制

  需要我帮您查看具体的监控数据吗？

  用户B：@AI助手 刚才讨论的是什么问题？

  被动回复 Agent：
  刚才我和 @用户A 讨论的是**登录性能问题**：

  **问题现状**：用户反馈登录慢，监控显示响应时间明显增加
  **分析结果**：平均响应时间从500ms增加到2.5秒
  **解决方案**：已提供立即处理和短期优化建议

  您需要了解更多详细信息吗？
  ```


  ::
  ::

  ::tab{label="群聊总结"}
  ::card
  仅 @机器人时自动生成对话总结

  **示例对话**：
  ```text
  用户：@AI助手

  被动回复 Agent：
  **过去1小时群聊总结** (14:00-15:00)

  **主要讨论**：
  1. **登录性能问题** - @用户A 反馈用户登录慢
     - 现状：响应时间从500ms增加到2.5秒
     - 解决方案：已提供数据库和缓存优化建议

  2. **新版本发布** - @用户C 确认v2.1.3版本计划
     - 时间：明天下午2点发布
     - 内容：修复支付接口bug，优化查询性能

  3. **监控告警** - @用户B 处理数据库连接告警
     - 结果：已通过增加连接池大小解决

  **待办事项**：
  - [ ] @用户A 检查数据库慢查询日志 (今天)
  - [ ] @用户C 准备发布文档 (明天上午)
  - [ ] @用户B 更新监控阈值配置 (本周)

  **关键决策**：
  - 同意推迟性能优化到下个版本
  - 计划下周进行数据库索引重建
  ```
  ::
  ::
::


## 效果展示

| 被动响应指令 | 被动响应指令 |
|-----------|-------------|
| ![](images/chatops/reactive_at.png) | ![](images/chatops/reactive_reply.png) |


## 实践与优化建议


::tabs

    ::tab{label="上下文内容"}
    Reactive Agent 会自动获取群聊历史消息，理解上下文内容

    同时可以调节获取的上下文长度
    ::


    ::tab{label="工具/子Agent"}

    支持通过Tools与Sub Agent扩展能力，但需注意执行时间与返回的内容质量
    ::

::
